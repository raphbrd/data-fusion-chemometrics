# Data-fusion in analytical chemistry

Authors: Thomas Pasquier, Raphael Bordas (Master 2 Mathematics and Artificial Intelligence, Paris-Saclay University)

This repository contains the code and data used for the analysis of the data fusion problem in analytical chemistry
from Acar et al. (2011, 2014). The main goal is to implement coupled matrix tensor factorization (CMTF) using an
ALS-based optimization.

## Code organization

- `run_cmtf_experiments.py`: Entry point to run the CMTF experiments. It is recommended to run it from the command line.
  Arguments are
    - `--rank`: Rank of the decomposition. Default is 5.
    - `--max-iter`: Maximum number of iterations for the ALS algorithm. Default is 10000.
    - `--cmtf`: If specified, the CMTF algorithm will be run.
    - `--plot`: If specified, the figures will be generated.
- `cmtf.py`: Contains the main class with an ALS-based implementation of the coupled matrix tensor decomposition
- `data/`: Contains the data from Acar et al. 2014 used in all analysis.
- `figures/`: Contains the figures generated by all scripts. It is created by the `main.py` script if it does not exist.
- `output_data/`: Contains the output of the examples. It is created by the `main.py` script if it does not exist.

An additional Jupyter notebook contains analyses using PARAFAC decomposition.

## Usage example

- To reproduce the figures from the report:

```
python run_cmtf_experiments.py --rank=5 --max-iter=10000 --cmtf --plot
```

- To run the CMTF algorithm:

```python
from cmtf import CMTF

# assumed at least a tensor and a matrix are loaded in the workspace

cmtf = CMTF(rank=3)
out = cmtf.fit([tensor], [matrix])  # both tensor and matrix should be in a list

# out is a list of factors
# out[0] is the common factor to all tensors and matrices
# out[1] and out[2] are the factors for the first tensor
# ...
# out[-1] is the factor of the last matrix
```
